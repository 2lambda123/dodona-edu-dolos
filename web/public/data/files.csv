id,path,content,ast
8,samples/python/benchmark_files/UPGMA_A_B_combined.py,"from collections import defaultdict

import numpy as np
import sys

#from A, except some functions
class DistanceMatrix:
    def __init__(self, *args):
        self.D = np.array(*args)
        return

    def __str__(self):
        return str([[float(a) for a in x] for x in self.D])

    def __repr__(self):
        return type(self).__name__ + ""("" + str([[float(a) for a in x] for x in self.D]) + "")""

    @staticmethod
    def loadtxt(file_name, dtype=None, comments='#', delimiter=None, converters=None, skiprows=0, usecols=None, unpack=False, ndmin=0):
        D = np.loadtxt(file_name, dtype, comments, delimiter, converters, skiprows, usecols, unpack, ndmin)
        return DistanceMatrix(D)

    def savetxt(self, output_file, fmt='%.18e', delimiter=' ', newline='\n', header='', footer='', comments='# '):
        np.savetxt(output_file, self.D, fmt, delimiter, newline, header, footer, comments)
        return

    def nr_leaves(self):
        return len(self.D)

    def limb_length(self, j):
        n = self.nr_leaves()
        assert(j < n)
        minimum = sys.maxsize
        for i in range(n):
            if i != j:
                for k in range(n):
                    if k != j:
                        Dij = self.D[i][j]
                        Djk = self.D[j][k]
                        Dik = self.D[i][k]
                        minimum = min([minimum, (Dij+Djk-Dik)/2])
        return minimum

    #from B
    def additive_phylogeny(self):
        self.max_node = len(self.matrix)
        return UnrootedTree(*sorted(self.additive_phylogeny_recursive(self.matrix, len(self.matrix))))

    #from B
    def additive_phylogeny_recursive(self, mat, n):
        if n == 2:
            return [(0, 1, mat[0][1])]
        limb_size = DistanceMatrix.limb_length_from_matrix(mat[:n, :n], n - 1)
        for j in range(n - 1):
            mat[n - 1][j] = mat[n - 1][j] - limb_size
            mat[j][n - 1] = mat[n - 1][j]
        for i in range(n - 1):
            found = False
            for k in range(i, n - 1):
                if mat[i][k] == mat[i][n - 1] + mat[k][n - 1]:
                    found = True
                    break
            if found:
                break
        x = mat[i][n - 1]
        tree_list = self.additive_phylogeny_recursive(mat.copy(), n - 1)
        tree = UnrootedTree(*tree_list)
        path = tree.path(i, k)
        for j in range(1, len(path)):
            edge = (path[j - 1], path[j])
            edge_sorted = tuple(sorted(edge))
            if tree.edges[edge_sorted] > x:
                tree_list.remove((edge_sorted[0], edge_sorted[1], tree.edges[edge_sorted]))
                tree_list.append((edge[0], self.max_node, x))
                tree_list.append((edge[1], self.max_node, tree.edges[edge_sorted] - x))
                tree_list.append((n - 1, self.max_node, limb_size))
                self.max_node += 1
                break
            elif tree.edges[edge_sorted] == x:
                new_edge = sorted((n - 1, edge[1]))
                tree_list.append((new_edge[0], new_edge[1], limb_size))
                break
            else:
                x -= tree.edges[edge_sorted]

        return tree_list

    def UPGMA(self):
        self.nr_count = self.nr_leaves()
        clusters = [{i} for i in range(self.nr_leaves())]
        trees = [Tree(i) for i in range(self.nr_leaves())]
        ages = [0 for _ in range(self.nr_leaves())]
        while len(clusters) > 1:
            min_d = sys.maxsize
            min_C1, min_C2 = None, None
            n = len(clusters)
            for i in range(n):
                for j in range(i+1,n):
                    C1, C2 = clusters[i], clusters[j]
                    d = self.pairwise_distance(C1,C2)
                    if d < min_d:
                        min_d = d
                        min_C1, min_C2 = C1, C2

            C1_index, C2_index = clusters.index(min_C1), clusters.index(min_C2)
            age = min_d/2
            clusters[C1_index] = min_C1 | min_C2
            clusters.pop(C2_index)
            trees[C1_index] = Tree(self.nr_count, (trees[C1_index], age - ages[C1_index]), (trees[C2_index], age - ages[C2_index] ))
            trees.pop(C2_index)
            ages[C1_index] = age
            ages.pop(C2_index)
            self.nr_count += 1
        return trees[0]

    def pairwise_distance(self,C1, C2):
        n, m = len(C1), len(C2)
        s = sum([self.D[i][j] for i in C1 for j in C2])
        return s/(n*m)

#from B completely
class UnrootedTree:

    def __init__(self, *args):
        self.graph = defaultdict(set)
        self.edges = defaultdict(int)
        self.nodes = set()
        self.edges_list = list()
        self.leaves = set()
        for tup in args:
            self.graph[tup[0]].add((tup[1]))
            self.graph[tup[1]].add((tup[0]))
            self.edges[tuple(sorted((tup[0], tup[1])))] = tup[2]
            self.edges_list.append((tup[0], tup[1], float(tup[2])))
            self.nodes.add(tup[0])
            self.nodes.add(tup[1])
        for key, val in self.graph.items():
            if len(val) == 1:
                self.leaves.add(key)

    def __repr__(self):
        repr_str = ""UnrootedTree(""
        for edge in self.edges_list:
            repr_str += str(edge) + "", ""
        return repr_str[:-2] + "")""

    @staticmethod
    def loadtxt(f):
        with open(f, ""r"") as graph_file:
            tuple_list = []
            for line in graph_file:
                line_arr = line.strip().split(""<->"")
                rhs = line_arr[1].split("":"")
                tuple_list.append((int(line_arr[0]), int(rhs[0]), float(rhs[1])))
            return UnrootedTree(*tuple_list)

    def path(self, first_node, second_node):
        stack = [(first_node, [first_node])]
        while stack:
            (vertex, path) = stack.pop()
            for next_vertex in self.graph[vertex] - set(path):
                if next_vertex == second_node:
                    return path + [next_vertex]
                else:
                    stack.append((next_vertex, path + [next_vertex]))

    def distance_matrix(self):
        mat = [[0 for _ in range(len(self.leaves))] for _ in range(len(self.leaves))]
        for n1 in self.leaves:
            for n2 in self.leaves:
                if n1 < n2:
                    path = self.path(n1, n2)
                    length = 0
                    for i in range(1, len(path)):
                        length += self.edges[tuple(sorted((path[i - 1], path[i])))]
                    mat[n1][n2] = length
                    mat[n2][n1] = length
        return DistanceMatrix(mat)

#from A
class Tree:
    def __init__(self, root, *subtrees):
        self.root = root
        self.subtrees = subtrees

    def __str__(self):
        subtrees_str = "", "".join([str(tree) for tree in self.subtrees])
        return type(self).__name__ + ""("" + str(self.root) + ("", "" if len(self.subtrees) > 0 else """") + subtrees_str + "")""

    def __repr__(self):
        return self.__str__()
",(program (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (import_clause (identifier)) (ERROR (ERROR)) (identifier) (identifier) (identifier) (identifier) (ERROR (identifier) (identifier)) (identifier) (parenthesized_expression (binary_expression (identifier) (ERROR) (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (ERROR) (identifier))))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (binary_expression (binary_expression (binary_expression (member_expression (call_expression (identifier) (arguments (identifier))) (property_identifier)) (string)) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (string))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier)))) (expression_statement (identifier)) (expression_statement (call_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string (escape_sequence))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)))) (ERROR (identifier)) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (call_expression (identifier) (arguments (binary_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (member_expression (identifier) (property_identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (binary_expression (identifier) (identifier)) (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (identifier) (identifier)) (identifier))) (number))))))) (return_statement (identifier)) (ERROR (ERROR)) (expression_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))))) (return_statement (call_expression (identifier) (arguments (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))))))))))) (ERROR (ERROR)) (expression_statement (identifier)) (expression_statement (identifier)) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier) (identifier) (identifier))) (ERROR (identifier)) (subscript_expression (number) (ERROR) (parenthesized_expression (sequence_expression (number) (sequence_expression (number) (subscript_expression (subscript_expression (identifier) (number)) (number)))))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (ERROR) (sequence_expression (identifier) (ERROR) (identifier))) (binary_expression (identifier) (number)))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (assignment_expression (subscript_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (identifier)) (binary_expression (subscript_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (identifier)) (identifier))))) (expression_statement (assignment_expression (subscript_expression (subscript_expression (identifier) (identifier)) (binary_expression (identifier) (number))) (subscript_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (identifier)))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (assignment_expression (identifier) (identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier) (binary_expression (identifier) (number)))))) (expression_statement (binary_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (binary_expression (subscript_expression (subscript_expression (identifier) (identifier)) (binary_expression (identifier) (number))) (ERROR (subscript_expression (subscript_expression (identifier) (identifier)) (binary_expression (identifier) (number)))) (assignment_expression (identifier) (identifier))))) (break_statement) (ERROR) (labeled_statement (statement_identifier) (break_statement)) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (identifier) (identifier)) (binary_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)) (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (ERROR) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (number) (call_expression (identifier) (arguments (identifier)))))) (assignment_expression (identifier) (parenthesized_expression (sequence_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (subscript_expression (identifier) (identifier))))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (call_expression (identifier) (arguments (identifier))))))) (ERROR) (expression_statement (binary_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (ERROR (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (number)) (sequence_expression (subscript_expression (identifier) (number)) (subscript_expression (member_expression (identifier) (property_identifier)) (identifier))))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (number)) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (number)) (sequence_expression (member_expression (identifier) (property_identifier)) (binary_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (binary_expression (identifier) (number)) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (break_statement) (expression_statement (binary_expression (subscript_expression (member_expression (identifier) (ERROR (identifier)) (property_identifier)) (identifier)) (ERROR (identifier)) (assignment_expression (identifier) (call_expression (identifier) (arguments (parenthesized_expression (sequence_expression (binary_expression (identifier) (number)) (subscript_expression (identifier) (number))))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (number)) (sequence_expression (subscript_expression (identifier) (number)) (identifier))))))) (break_statement) (labeled_statement (statement_identifier) (expression_statement (augmented_assignment_expression (identifier) (subscript_expression (member_expression (identifier) (property_identifier)) (identifier))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (assignment_expression (identifier) (array (binary_expression (object (shorthand_property_identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (ERROR (number)) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number)) (assignment_expression (identifier) (member_expression (identifier) (property_identifier))))) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (sequence_expression (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier)))) (identifier)) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR (identifier)) (expression_statement (call_expression (jsx_self_closing_element (jsx_namespace_name (identifier) (identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier))) (arguments (binary_expression (identifier) (identifier))))) (ERROR (ERROR)) (expression_statement (identifier)) (expression_statement (identifier)) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)) (expression_statement (string)) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (member_expression (identifier) (property_identifier))) (augmented_assignment_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (string))))) (return_statement (binary_expression (subscript_expression (identifier) (ERROR) (unary_expression (number))) (string))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier))) (call_expression (identifier) (arguments (identifier) (string)))) (labeled_statement (statement_identifier) (expression_statement (assignment_expression (identifier) (array)))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (call_expression (member_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments)) (property_identifier)) (arguments (string)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (subscript_expression (identifier) (number)) (property_identifier)) (arguments (string))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))) (sequence_expression (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))) (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))))))))) (return_statement (call_expression (identifier) (arguments (ERROR) (identifier)))) (ERROR (call_expression (identifier) (ERROR (identifier)) (arguments (identifier) (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (array (parenthesized_expression (sequence_expression (identifier) (array (identifier))))))) (ERROR) (labeled_statement (statement_identifier) (expression_statement (assignment_expression (parenthesized_expression (sequence_expression (identifier) (identifier))) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (ERROR (binary_expression (identifier) (binary_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (call_expression (identifier) (arguments (identifier))))) (binary_expression (identifier) (identifier))) (return_statement (binary_expression (identifier) (array (identifier)))) (labeled_statement (statement_identifier) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (identifier) (binary_expression (identifier) (array (identifier))))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier))) (identifier) (number) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))))) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))))) (binary_expression (identifier) (member_expression (identifier) (property_identifier))) (binary_expression (identifier) (member_expression (identifier) (property_identifier)))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (number))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (number) (call_expression (identifier) (arguments (identifier)))))) (augmented_assignment_expression (identifier) (subscript_expression (member_expression (identifier) (property_identifier)) (call_expression (identifier) (arguments (call_expression (identifier) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (subscript_expression (identifier) (identifier)))))))))))) (expression_statement (assignment_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (identifier))) (expression_statement (assignment_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (identifier))) (return_statement (call_expression (identifier) (arguments (identifier)))) (ERROR (ERROR)) (expression_statement (identifier)) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)))
9,samples/python/benchmark_files/UPGMA_A_copy.py,"from collections import defaultdict

import numpy as np
import sys

class DistanceMatrix:
    def __init__(self, *args):
        self.D = np.array(*args)
        return

    def __str__(self):
        return str([[float(a) for a in x] for x in self.D])

    def __repr__(self):
        return type(self).__name__ + ""("" + str([[float(a) for a in x] for x in self.D]) + "")""

    @staticmethod
    def loadtxt(file_name, dtype=None, comments='#', delimiter=None, converters=None, skiprows=0, usecols=None, unpack=False, ndmin=0):
        D = np.loadtxt(file_name, dtype, comments, delimiter, converters, skiprows, usecols, unpack, ndmin)
        return DistanceMatrix(D)

    def savetxt(self, output_file, fmt='%.18e', delimiter=' ', newline='\n', header='', footer='', comments='# '):
        np.savetxt(output_file, self.D, fmt, delimiter, newline, header, footer, comments)
        return

    def nr_leaves(self):
        return len(self.D)

    def limb_length(self, j):
        n = self.nr_leaves()
        assert(j < n)
        minimum = sys.maxsize
        for i in range(n):
            if i != j:
                for k in range(n):
                    if k != j:
                        Dij = self.D[i][j]
                        Djk = self.D[j][k]
                        Dik = self.D[i][k]
                        minimum = min([minimum, (Dij+Djk-Dik)/2])
        return minimum

    def additive_phylogeny(self):
        self.node_count = self.nr_leaves()
        return self.additive_phylogeny_rec(self, self.nr_leaves())

    def find_i_n_k(self, n):
        for i in range(n-1):
            for k in range(n-1):
                if i != k:
                    if self.D[i][k] == self.D[i][n-1] + self.D[n-1][k]:
                        return (i, n, k)
        return ""nop""

    def additive_phylogeny_rec(self, D, n):
        if n == 3:
            ll1 = (D.D[0][1] + D.D[1][2] - D.D[0][2])/2
            ll2 = D.D[1][2] - ll1
            ll0 = D.D[0][1] - ll1
            edges = {(0, self.node_count, ll0), (1, self.node_count, ll1), (2, self.node_count, ll2)}
            self.node_count += 1
            return UnrootedTree(*edges)

        ll = D.limb_length(n-1)
        D_bald = DistanceMatrix(D.D[:])
        for x in range(n-1):
            D_bald.D[n-1][x] -= ll
            D_bald.D[x][n-1] -= ll

        i,n,k = D_bald.find_i_n_k(n)
        x = D_bald.D[i][n-1]
        trimmed_D = DistanceMatrix([[D_bald.D[a][b] for a in range(n-1)] for b in range(n-1)])
        T = self.additive_phylogeny_rec(trimmed_D, n-1)
        path = T.path(i,k)
        i = 1
        while i < len(path) -1 and T.distance(path[0],path[i]) < x:
            i += 1

        if i is not 0 and  T.distance(path[0],path[i]) == x:
            T.add_edge(path[i-1],n-1,ll)
        else:
            a,b = path[i-1],path[i]
            new_d = D.D[path[0]][b] - x if b < len(D.D) else T.distance(path[0],b) - x
            T.add_edge(self.node_count, b, new_d)
            T.add_edge(a, self.node_count, T.distance(a,b) - new_d)
            T.add_edge(n-1, self.node_count, ll)
            T.remove_edge(a, b)
            self.node_count += 1

        return T

    def UPGMA(self):
        self.nr_count = self.nr_leaves()
        clusters = [{i} for i in range(self.nr_leaves())]
        trees = [Tree(i) for i in range(self.nr_leaves())]
        ages = [0 for _ in range(self.nr_leaves())]
        while len(clusters) > 1:
            min_d = sys.maxsize
            min_C1, min_C2 = None, None
            n = len(clusters)
            for i in range(n):
                for j in range(i+1,n):
                    C1, C2 = clusters[i], clusters[j]
                    d = self.pairwise_distance(C1,C2)
                    if d < min_d:
                        min_d = d
                        min_C1, min_C2 = C1, C2

            C1_index, C2_index = clusters.index(min_C1), clusters.index(min_C2)
            age = min_d/2
            clusters[C1_index] = min_C1 | min_C2
            clusters.pop(C2_index)
            trees[C1_index] = Tree(self.nr_count, (trees[C1_index], age - ages[C1_index]), (trees[C2_index], age - ages[C2_index] ))
            trees.pop(C2_index)
            ages[C1_index] = age
            ages.pop(C2_index)
            self.nr_count += 1
        return trees[0]

    def pairwise_distance(self,C1, C2):
        n, m = len(C1), len(C2)
        s = sum([self.D[i][j] for i in C1 for j in C2])
        return s/(n*m)

class UnrootedTree:
    def __init__(self, *edges):
        self.edges = list()
        for edge in edges:
            a,b,c = edge
            a, b, c = int(a), int(b), float(c)
            self.edges.append((a,b,c))
        d = dict()
        for edge in self.edges:
            x, y, w = edge
            d[(x, y)] = w
            d[(y, x)] = w
        self.d = d
        nb = defaultdict(list)
        for edge in self.edges:
            x, y, w = edge
            nb[x].append(y)
            nb[y].append(x)
        self.nb = nb

    def __str__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def __repr__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def add_edge(self, a,b,w):
        self.edges.append((a,b,w))
        self.d[(a,b)] = w
        self.d[(b,a)] = w
        self.nb[a].append(b)
        self.nb[b].append(a)

    def remove_edge(self,a,b):
        for edge in self.edges:
            x,y,w = edge
            if (x == a and b == y) or (x == b and y == a):
                self.edges.remove(edge)
                break
        del self.d[(a,b)]
        del self.d[(b,a)]
        self.nb[a].remove(b)
        self.nb[b].remove(a)

    @staticmethod
    def loadtxt(input_file):
        edges = list()
        f = open(input_file)
        for line in f:
            line = line.rstrip().split("":"")
            line[0] = line[0].split(""<->"")
            edges.append((line[0][0],line[0][1],line[1]))

        return UnrootedTree(*edges)

    def path(self, i, j):
        self.visited = [i]
        p = self.path_dfs(self.nb, i, j, [i])
        if p[0] != i:
            p = p [::-1]
        return p

    def distance(self, i,j):
        if (i,j) in self.d:
            return self.d[(i,j)]
        else:
            path = self.path(i,j)
            return self.path_weight(path)

    def path_dfs(self, graph, current_i, j, current_path):
        nb = graph[current_i]
        for n in nb:
            if n not in self.visited:
                self.visited.append(n)
                if n == j:
                    return current_path + [j]
                else:
                    r = self.path_dfs(graph, n, j, current_path + [n])
                    if r:
                        return r

    def nr_leaf_nodes(self):
        s = set()
        for edge in self.edges:
            x,y,w = edge
            if len(self.nb[x]) == 1:
                s.add(x)
            if len(self.nb[y]) == 1:
                s.add(y)
        return len(s)

    def path_weight(self, path):
        s = 0
        for i in range(len(path) -1):
            s += self.d[(path[i],path[i+1])]
        return s

    def distance_matrix(self):
        n = self.nr_leaf_nodes()
        D = [[0 for _ in range(n)] for _ in range(n)]
        self.path_weight(self.path(0,2))
        for i in range(n):
            for j in range(i+1,n):
                path = self.path(i,j)
                w = self.path_weight(path)
        D[i][j], D[j][i] = w, w
        return DistanceMatrix(D)

class Tree:
    def __init__(self, root, *subtrees):
        self.root = root
        self.subtrees = subtrees

    def __str__(self):
        subtrees_str = "", "".join([str(tree) for tree in self.subtrees])
        return type(self).__name__ + ""("" + str(self.root) + ("", "" if len(self.subtrees) > 0 else """") + subtrees_str + "")""

    def __repr__(self):
        return self.__str__()

",(program (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR (identifier) (identifier)) (identifier) (parenthesized_expression (binary_expression (identifier) (ERROR) (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (ERROR) (identifier))))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (binary_expression (binary_expression (binary_expression (member_expression (call_expression (identifier) (arguments (identifier))) (property_identifier)) (string)) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (string))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier)))) (expression_statement (identifier)) (expression_statement (call_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string (escape_sequence))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)))) (ERROR (identifier)) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (call_expression (identifier) (arguments (binary_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (member_expression (identifier) (property_identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (binary_expression (identifier) (identifier)) (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (identifier) (identifier)) (identifier))) (number))))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier))))) (return_statement (parenthesized_expression (sequence_expression (identifier) (sequence_expression (identifier) (identifier))))) (return_statement (string)) (expression_statement (identifier)) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier) (identifier) (identifier))) (ERROR (identifier)) (ERROR (number)) (assignment_expression (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)))) (number))))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (sequence_expression (assignment_expression (identifier) (ERROR) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))) (sequence_expression (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier)))) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (ERROR) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (call_expression (identifier) (arguments (ERROR) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)) (ERROR))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier)) (identifier)))) (expression_statement (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (identifier))) (expression_statement (sequence_expression (identifier) (sequence_expression (identifier) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier))))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (number))) (ERROR) (expression_statement (binary_expression (binary_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number) (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))))) (ERROR (identifier)) (augmented_assignment_expression (identifier) (number)))) (ERROR (identifier) (identifier) (identifier) (number)) (expression_statement (binary_expression (call_expression (member_expression (identifier) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))) (ERROR (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (binary_expression (identifier) (number))) (binary_expression (identifier) (number)) (identifier))))) (labeled_statement (statement_identifier) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (binary_expression (identifier) (number)))) (subscript_expression (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (subscript_expression (identifier) (number))) (identifier)) (identifier)) (ERROR (identifier)) (binary_expression (call_expression (member_expression (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (identifier) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (binary_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)) (member_expression (identifier) (property_identifier)) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (assignment_expression (identifier) (array (binary_expression (object (shorthand_property_identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (ERROR (number)) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number)) (assignment_expression (identifier) (member_expression (identifier) (property_identifier))))) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (sequence_expression (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier)))) (identifier)) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR (identifier)) (expression_statement (call_expression (jsx_self_closing_element (jsx_namespace_name (identifier) (identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier))) (arguments (binary_expression (identifier) (identifier))))) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (number) (identifier) (number) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)))
10,samples/python/benchmark_files/UPGMA_A_functioncopied.py,"from collections import defaultdict

import numpy as np
import sys

class DistanceMatrix:
    def __init__(self, *args):
        self.D = np.array(*args)
        return

    def __str__(self):
        return str([[float(a) for a in x] for x in self.D])

    def __repr__(self):
        return type(self).__name__ + ""("" + str([[float(a) for a in x] for x in self.D]) + "")""

    @staticmethod
    def loadtxt(file_name, dtype=None, comments='#', delimiter=None, converters=None, skiprows=0, usecols=None, unpack=False, ndmin=0):
        D = np.loadtxt(file_name, dtype, comments, delimiter, converters, skiprows, usecols, unpack, ndmin)
        return DistanceMatrix(D)

    def savetxt(self, output_file, fmt='%.18e', delimiter=' ', newline='\n', header='', footer='', comments='# '):
        np.savetxt(output_file, self.D, fmt, delimiter, newline, header, footer, comments)
        return

    def nr_leaves(self):
        return len(self.D)

    def limb_length(self, j):
        n = self.nr_leaves()
        assert(j < n)
        minimum = sys.maxsize
        for i in range(n):
            if i != j:
                for k in range(n):
                    if k != j:
                        Dij = self.D[i][j]
                        Djk = self.D[j][k]
                        Dik = self.D[i][k]
                        minimum = min([minimum, (Dij+Djk-Dik)/2])
        return minimum

    def additive_phylogeny(self):
        self.node_count = self.nr_leaves()
        return self.additive_phylogeny_rec(self, self.nr_leaves())

    def find_i_n_k(self, n):
        for i in range(n-1):
            for k in range(n-1):
                if i != k:
                    if self.D[i][k] == self.D[i][n-1] + self.D[n-1][k]:
                        return (i, n, k)
        return ""nop""

    def additive_phylogeny_rec(self, D, n):
        if n == 3:
            ll1 = (D.D[0][1] + D.D[1][2] - D.D[0][2])/2
            ll2 = D.D[1][2] - ll1
            ll0 = D.D[0][1] - ll1
            edges = {(0, self.node_count, ll0), (1, self.node_count, ll1), (2, self.node_count, ll2)}
            self.node_count += 1
            return UnrootedTree(*edges)

        ll = D.limb_length(n-1)
        D_bald = DistanceMatrix(D.D[:])
        for x in range(n-1):
            D_bald.D[n-1][x] -= ll
            D_bald.D[x][n-1] -= ll

        i,n,k = D_bald.find_i_n_k(n)
        x = D_bald.D[i][n-1]
        trimmed_D = DistanceMatrix([[D_bald.D[a][b] for a in range(n-1)] for b in range(n-1)])
        T = self.additive_phylogeny_rec(trimmed_D, n-1)
        path = T.path(i,k)
        i = 1
        while i < len(path) -1 and T.distance(path[0],path[i]) < x:
            i += 1

        if i is not 0 and  T.distance(path[0],path[i]) == x:
            T.add_edge(path[i-1],n-1,ll)
        else:
            a,b = path[i-1],path[i]
            new_d = D.D[path[0]][b] - x if b < len(D.D) else T.distance(path[0],b) - x
            T.add_edge(self.node_count, b, new_d)
            T.add_edge(a, self.node_count, T.distance(a,b) - new_d)
            T.add_edge(n-1, self.node_count, ll)
            T.remove_edge(a, b)
            self.node_count += 1

        return T

    def UPGMA(self):
        self.nr_count = self.nr_leaves()
        clusters = [{i} for i in range(self.nr_leaves())]
        trees = [Tree(i) for i in range(self.nr_leaves())]
        ages = [0 for _ in range(self.nr_leaves())]
        while len(clusters) > 1:
            min_d = sys.maxsize
            min_C1, min_C2 = None, None
            n = len(clusters)
            for i in range(n):
                for j in range(i+1,n):
                    C1, C2 = clusters[i], clusters[j]
                    d = self.pairwise_distance(C1,C2)
                    if d < min_d:
                        min_d = d
                        min_C1, min_C2 = C1, C2

            C1_index, C2_index = clusters.index(min_C1), clusters.index(min_C2)
            age = min_d/2
            clusters[C1_index] = min_C1 | min_C2
            clusters.pop(C2_index)
            trees[C1_index] = Tree(self.nr_count, (trees[C1_index], age - ages[C1_index]), (trees[C2_index], age - ages[C2_index] ))
            trees.pop(C2_index)
            ages[C1_index] = age
            ages.pop(C2_index)
            self.nr_count += 1
        return trees[0]

    def pairwise_distance(self,C1, C2):
        n, m = len(C1), len(C2)
        s = sum([self.D[i][j] for i in C1 for j in C2])
        return s/(n*m)

class UnrootedTree:
    def __init__(self, *edges):
        self.edges = list()
        for edge in edges:
            a,b,c = edge
            a, b, c = int(a), int(b), float(c)
            self.edges.append((a,b,c))
        d = dict()
        for edge in self.edges:
            x, y, w = edge
            d[(x, y)] = w
            d[(y, x)] = w
        self.d = d
        nb = defaultdict(list)
        for edge in self.edges:
            x, y, w = edge
            nb[x].append(y)
            nb[y].append(x)
        self.nb = nb

    def __str__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def __repr__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def add_edge(self, a,b,w):
        self.edges.append((a,b,w))
        self.d[(a,b)] = w
        self.d[(b,a)] = w
        self.nb[a].append(b)
        self.nb[b].append(a)

    def remove_edge(self,a,b):
        for edge in self.edges:
            x,y,w = edge
            if (x == a and b == y) or (x == b and y == a):
                self.edges.remove(edge)
                break
        del self.d[(a,b)]
        del self.d[(b,a)]
        self.nb[a].remove(b)
        self.nb[b].remove(a)

    #from B
    @staticmethod
    def loadtxt(f):
        with open(f, ""r"") as graph_file:
            tuple_list = []
            for line in graph_file:
                line_arr = line.strip().split(""<->"")
                rhs = line_arr[1].split("":"")
                tuple_list.append((int(line_arr[0]), int(rhs[0]), float(rhs[1])))
            return UnrootedTree(*tuple_list)

    def path(self, i, j):
        self.visited = [i]
        p = self.path_dfs(self.nb, i, j, [i])
        if p[0] != i:
            p = p [::-1]
        return p

    def distance(self, i,j):
        if (i,j) in self.d:
            return self.d[(i,j)]
        else:
            path = self.path(i,j)
            return self.path_weight(path)

    def path_dfs(self, graph, current_i, j, current_path):
        nb = graph[current_i]
        for n in nb:
            if n not in self.visited:
                self.visited.append(n)
                if n == j:
                    return current_path + [j]
                else:
                    r = self.path_dfs(graph, n, j, current_path + [n])
                    if r:
                        return r

    def nr_leaf_nodes(self):
        s = set()
        for edge in self.edges:
            x,y,w = edge
            if len(self.nb[x]) == 1:
                s.add(x)
            if len(self.nb[y]) == 1:
                s.add(y)
        return len(s)

    def path_weight(self, path):
        s = 0
        for i in range(len(path) -1):
            s += self.d[(path[i],path[i+1])]
        return s

    def distance_matrix(self):
        n = self.nr_leaf_nodes()
        D = [[0 for _ in range(n)] for _ in range(n)]
        self.path_weight(self.path(0,2))
        for i in range(n):
            for j in range(i+1,n):
                path = self.path(i,j)
                w = self.path_weight(path)
        D[i][j], D[j][i] = w, w
        return DistanceMatrix(D)

class Tree:
    def __init__(self, root, *subtrees):
        self.root = root
        self.subtrees = subtrees

    def __str__(self):
        subtrees_str = "", "".join([str(tree) for tree in self.subtrees])
        return type(self).__name__ + ""("" + str(self.root) + ("", "" if len(self.subtrees) > 0 else """") + subtrees_str + "")""

    def __repr__(self):
        return self.__str__()
",(program (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR (identifier) (identifier)) (identifier) (parenthesized_expression (binary_expression (identifier) (ERROR) (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (ERROR) (identifier))))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (binary_expression (binary_expression (binary_expression (member_expression (call_expression (identifier) (arguments (identifier))) (property_identifier)) (string)) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (string))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier)))) (expression_statement (identifier)) (expression_statement (call_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string (escape_sequence))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)))) (ERROR (identifier)) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (call_expression (identifier) (arguments (binary_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (member_expression (identifier) (property_identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (binary_expression (identifier) (identifier)) (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (identifier) (identifier)) (identifier))) (number))))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier))))) (return_statement (parenthesized_expression (sequence_expression (identifier) (sequence_expression (identifier) (identifier))))) (return_statement (string)) (expression_statement (identifier)) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier) (identifier) (identifier))) (ERROR (identifier)) (ERROR (number)) (assignment_expression (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)))) (number))))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (sequence_expression (assignment_expression (identifier) (ERROR) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))) (sequence_expression (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier)))) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (ERROR) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (call_expression (identifier) (arguments (ERROR) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)) (ERROR))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier)) (identifier)))) (expression_statement (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (identifier))) (expression_statement (sequence_expression (identifier) (sequence_expression (identifier) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier))))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (number))) (ERROR) (expression_statement (binary_expression (binary_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number) (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))))) (ERROR (identifier)) (augmented_assignment_expression (identifier) (number)))) (ERROR (identifier) (identifier) (identifier) (number)) (expression_statement (binary_expression (call_expression (member_expression (identifier) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))) (ERROR (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (binary_expression (identifier) (number))) (binary_expression (identifier) (number)) (identifier))))) (labeled_statement (statement_identifier) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (binary_expression (identifier) (number)))) (subscript_expression (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (subscript_expression (identifier) (number))) (identifier)) (identifier)) (ERROR (identifier)) (binary_expression (call_expression (member_expression (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (identifier) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (binary_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)) (member_expression (identifier) (property_identifier)) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (assignment_expression (identifier) (array (binary_expression (object (shorthand_property_identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (ERROR (number)) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number)) (assignment_expression (identifier) (member_expression (identifier) (property_identifier))))) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (sequence_expression (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier)))) (identifier)) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR (identifier)) (expression_statement (call_expression (jsx_self_closing_element (jsx_namespace_name (identifier) (identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier))) (arguments (binary_expression (identifier) (identifier))))) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)) (expression_statement (assignment_expression (identifier) (array))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (call_expression (member_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments)) (property_identifier)) (arguments (string)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (subscript_expression (identifier) (number)) (property_identifier)) (arguments (string))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))) (sequence_expression (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))) (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))))))))) (return_statement (call_expression (identifier) (arguments (ERROR) (identifier)))) (ERROR (call_expression (identifier) (ERROR (identifier)) (arguments (identifier) (identifier) (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (array (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (identifier) (identifier) (array (identifier)))))) (ERROR) (expression_statement (binary_expression (subscript_expression (identifier) (number)) (ERROR (identifier)) (assignment_expression (identifier) (subscript_expression (identifier) (ERROR) (unary_expression (number)))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier) (identifier)))) (if_statement (parenthesized_expression (sequence_expression (identifier) (identifier))) (ERROR (identifier) (member_expression (identifier) (property_identifier))) (return_statement (subscript_expression (member_expression (identifier) (property_identifier)) (parenthesized_expression (sequence_expression (identifier) (identifier))))) (ERROR) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier)))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier) (identifier) (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (identifier) (identifier)))) (ERROR (binary_expression (identifier) (identifier))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (ERROR (member_expression (identifier) (property_identifier))) (call_expression (member_expression (member_expression (identifier) (property_identifier)) (property_identifier)) (arguments (identifier))))) (ERROR (binary_expression (identifier) (identifier))) (return_statement (binary_expression (identifier) (array (identifier)))) (labeled_statement (statement_identifier) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (binary_expression (identifier) (array (identifier)))))))) (ERROR) (labeled_statement (statement_identifier) (return_statement (identifier))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments)))) (ERROR) (expression_statement (sequence_expression (binary_expression (identifier) (ERROR (member_expression (identifier) (property_identifier))) (identifier)) (sequence_expression (identifier) (assignment_expression (identifier) (identifier))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)))) (ERROR (number)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)))) (ERROR (number)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier)))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (number))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (call_expression (identifier) (arguments (identifier))) (number))))) (augmented_assignment_expression (identifier) (subscript_expression (member_expression (identifier) (property_identifier)) (parenthesized_expression (sequence_expression (subscript_expression (identifier) (identifier)) (subscript_expression (identifier) (binary_expression (identifier) (number))))))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (assignment_expression (identifier) (array (binary_expression (array (ERROR (number)) (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (ERROR (identifier)) (call_expression (identifier) (arguments (identifier))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments (number) (number)))))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier)))) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier))))) (expression_statement (sequence_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (sequence_expression (assignment_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (identifier)) (identifier)))) (return_statement (call_expression (identifier) (arguments (identifier)))) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)))
11,samples/python/benchmark_files/UPGMA_A_functionsmoved.py,"from collections import defaultdict

import numpy as np
import sys

class Tree:
    def __str__(self):
        subtrees_str = "", "".join([str(tree) for tree in self.subtrees])
        return type(self).__name__ + ""("" + str(self.root) + ("", "" if len(self.subtrees) > 0 else """") + subtrees_str + "")""

    def __init__(self, root, *subtrees):
        self.root = root
        self.subtrees = subtrees

    def __repr__(self):
        return self.__str__()

class DistanceMatrix:
    def __init__(self, *args):
        self.D = np.array(*args)
        return

    @staticmethod
    def loadtxt(file_name, dtype=None, comments='#', delimiter=None, converters=None, skiprows=0, usecols=None, unpack=False, ndmin=0):
        D = np.loadtxt(file_name, dtype, comments, delimiter, converters, skiprows, usecols, unpack, ndmin)
        return DistanceMatrix(D)

    def __str__(self):
        return str([[float(a) for a in x] for x in self.D])

    def find_i_n_k(self, n):
        for i in range(n-1):
            for k in range(n-1):
                if i != k:
                    if self.D[i][k] == self.D[i][n-1] + self.D[n-1][k]:
                        return (i, n, k)
        return ""nop""

    def savetxt(self, output_file, fmt='%.18e', delimiter=' ', newline='\n', header='', footer='', comments='# '):
        np.savetxt(output_file, self.D, fmt, delimiter, newline, header, footer, comments)
        return

    def pairwise_distance(self,C1, C2):
        n, m = len(C1), len(C2)
        s = sum([self.D[i][j] for i in C1 for j in C2])
        return s/(n*m)

    def nr_leaves(self):
        return len(self.D)

    def limb_length(self, j):
        n = self.nr_leaves()
        assert(j < n)
        minimum = sys.maxsize
        for i in range(n):
            if i != j:
                for k in range(n):
                    if k != j:
                        Dij = self.D[i][j]
                        Djk = self.D[j][k]
                        Dik = self.D[i][k]
                        minimum = min([minimum, (Dij+Djk-Dik)/2])
        return minimum

    def additive_phylogeny(self):
        self.node_count = self.nr_leaves()
        return self.additive_phylogeny_rec(self, self.nr_leaves())

    def __repr__(self):
        return type(self).__name__ + ""("" + str([[float(a) for a in x] for x in self.D]) + "")""

    def UPGMA(self):
        self.nr_count = self.nr_leaves()
        clusters = [{i} for i in range(self.nr_leaves())]
        trees = [Tree(i) for i in range(self.nr_leaves())]
        ages = [0 for _ in range(self.nr_leaves())]
        while len(clusters) > 1:
            min_d = sys.maxsize
            min_C1, min_C2 = None, None
            n = len(clusters)
            for i in range(n):
                for j in range(i+1,n):
                    C1, C2 = clusters[i], clusters[j]
                    d = self.pairwise_distance(C1,C2)
                    if d < min_d:
                        min_d = d
                        min_C1, min_C2 = C1, C2

            C1_index, C2_index = clusters.index(min_C1), clusters.index(min_C2)
            age = min_d/2
            clusters[C1_index] = min_C1 | min_C2
            clusters.pop(C2_index)
            trees[C1_index] = Tree(self.nr_count, (trees[C1_index], age - ages[C1_index]), (trees[C2_index], age - ages[C2_index] ))
            trees.pop(C2_index)
            ages[C1_index] = age
            ages.pop(C2_index)
            self.nr_count += 1
        return trees[0]

    def additive_phylogeny_rec(self, D, n):
        if n == 3:
            ll1 = (D.D[0][1] + D.D[1][2] - D.D[0][2])/2
            ll2 = D.D[1][2] - ll1
            ll0 = D.D[0][1] - ll1
            edges = {(0, self.node_count, ll0), (1, self.node_count, ll1), (2, self.node_count, ll2)}
            self.node_count += 1
            return UnrootedTree(*edges)

        ll = D.limb_length(n-1)
        D_bald = DistanceMatrix(D.D[:])
        for x in range(n-1):
            D_bald.D[n-1][x] -= ll
            D_bald.D[x][n-1] -= ll

        i,n,k = D_bald.find_i_n_k(n)
        x = D_bald.D[i][n-1]
        trimmed_D = DistanceMatrix([[D_bald.D[a][b] for a in range(n-1)] for b in range(n-1)])
        T = self.additive_phylogeny_rec(trimmed_D, n-1)
        path = T.path(i,k)
        i = 1
        while i < len(path) -1 and T.distance(path[0],path[i]) < x:
            i += 1

        if i is not 0 and  T.distance(path[0],path[i]) == x:
            T.add_edge(path[i-1],n-1,ll)
        else:
            a,b = path[i-1],path[i]
            new_d = D.D[path[0]][b] - x if b < len(D.D) else T.distance(path[0],b) - x
            T.add_edge(self.node_count, b, new_d)
            T.add_edge(a, self.node_count, T.distance(a,b) - new_d)
            T.add_edge(n-1, self.node_count, ll)
            T.remove_edge(a, b)
            self.node_count += 1

        return T

class UnrootedTree:
    def __str__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def add_edge(self, a,b,w):
        self.edges.append((a,b,w))
        self.d[(a,b)] = w
        self.d[(b,a)] = w
        self.nb[a].append(b)
        self.nb[b].append(a)

    def __repr__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def distance(self, i,j):
        if (i,j) in self.d:
            return self.d[(i,j)]
        else:
            path = self.path(i,j)
            return self.path_weight(path)

    def remove_edge(self,a,b):
        for edge in self.edges:
            x,y,w = edge
            if (x == a and b == y) or (x == b and y == a):
                self.edges.remove(edge)
                break
        del self.d[(a,b)]
        del self.d[(b,a)]
        self.nb[a].remove(b)
        self.nb[b].remove(a)

    def path(self, i, j):
        self.visited = [i]
        p = self.path_dfs(self.nb, i, j, [i])
        if p[0] != i:
            p = p [::-1]
        return p

    def __init__(self, *edges):
        self.edges = list()
        for edge in edges:
            a,b,c = edge
            a, b, c = int(a), int(b), float(c)
            self.edges.append((a,b,c))
        d = dict()
        for edge in self.edges:
            x, y, w = edge
            d[(x, y)] = w
            d[(y, x)] = w
        self.d = d
        nb = defaultdict(list)
        for edge in self.edges:
            x, y, w = edge
            nb[x].append(y)
            nb[y].append(x)
        self.nb = nb

    @staticmethod
    def loadtxt(input_file):
        edges = list()
        f = open(input_file)
        for line in f:
            line = line.rstrip().split("":"")
            line[0] = line[0].split(""<->"")
            edges.append((line[0][0],line[0][1],line[1]))

        return UnrootedTree(*edges)

    def path_weight(self, path):
        s = 0
        for i in range(len(path) -1):
            s += self.d[(path[i],path[i+1])]
        return s

    def distance_matrix(self):
        n = self.nr_leaf_nodes()
        D = [[0 for _ in range(n)] for _ in range(n)]
        self.path_weight(self.path(0,2))
        for i in range(n):
            for j in range(i+1,n):
                path = self.path(i,j)
                w = self.path_weight(path)
        D[i][j], D[j][i] = w, w
        return DistanceMatrix(D)

    def path_dfs(self, graph, current_i, j, current_path):
        nb = graph[current_i]
        for n in nb:
            if n not in self.visited:
                self.visited.append(n)
                if n == j:
                    return current_path + [j]
                else:
                    r = self.path_dfs(graph, n, j, current_path + [n])
                    if r:
                        return r

    def nr_leaf_nodes(self):
        s = set()
        for edge in self.edges:
            x,y,w = edge
            if len(self.nb[x]) == 1:
                s.add(x)
            if len(self.nb[y]) == 1:
                s.add(y)
        return len(s)
",(program (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR (identifier) (identifier)) (identifier) (formal_parameters (identifier))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (string) (property_identifier)) (arguments (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier)))))))) (return_statement (binary_expression (binary_expression (binary_expression (binary_expression (binary_expression (member_expression (call_expression (identifier) (arguments (identifier))) (property_identifier)) (string)) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (parenthesized_expression (binary_expression (call_expression (string) (ERROR (identifier)) (arguments (member_expression (identifier) (property_identifier)))) (ERROR (number)) (string)))) (identifier)) (string))) (expression_statement (identifier)) (expression_statement (assignment_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (ERROR) (identifier))) (ERROR (identifier)) (property_identifier)) (identifier))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (identifier))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments))) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)) (return_statement) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier)))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier))))) (return_statement (parenthesized_expression (sequence_expression (identifier) (sequence_expression (identifier) (identifier))))) (return_statement (string)) (expression_statement (identifier)) (expression_statement (call_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string (escape_sequence))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)))) (ERROR (identifier)) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)))) (return_statement) (expression_statement (identifier)) (expression_statement (sequence_expression (call_expression (identifier) (arguments (identifier) (identifier) (identifier))) (ERROR (identifier)) (sequence_expression (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (call_expression (identifier) (arguments (identifier)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (ERROR (identifier)) (identifier)) (ERROR (identifier)) (identifier))))))) (return_statement (binary_expression (identifier) (parenthesized_expression (binary_expression (identifier) (identifier))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (call_expression (identifier) (arguments (binary_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (member_expression (identifier) (property_identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (binary_expression (identifier) (identifier)) (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (identifier) (identifier)) (identifier))) (number))))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (binary_expression (binary_expression (binary_expression (member_expression (call_expression (identifier) (arguments (identifier))) (property_identifier)) (string)) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (string))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (assignment_expression (identifier) (array (binary_expression (object (shorthand_property_identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (ERROR (number)) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number)) (assignment_expression (identifier) (member_expression (identifier) (property_identifier))))) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (sequence_expression (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier)))) (identifier)) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR (identifier) (jsx_namespace_name (identifier) (identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (jsx_attribute (jsx_namespace_name (identifier) (ERROR (number)) (identifier))) (ERROR (identifier) (identifier) (number) (number) (identifier) (identifier) (number) (number) (identifier) (identifier) (number) (number) (number)) (jsx_attribute (property_identifier)) (ERROR (identifier) (identifier) (number) (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR (identifier) (identifier) (number) (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier) (jsx_expression (sequence_expression (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier)))) (sequence_expression (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier)))) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier)))))))) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (ERROR) (identifier))) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (identifier) (ERROR (number) (identifier)) (jsx_opening_element (nested_identifier (identifier) (ERROR (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier))) (identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (identifier) (identifier)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR (identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (ERROR (identifier) (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (jsx_namespace_name (identifier) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (ERROR) (identifier))) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR)) (jsx_text)))
12,samples/python/benchmark_files/UPGMA_A_linesmoved.py,"from collections import defaultdict

import numpy as np
import sys

class DistanceMatrix:
    def __init__(self, *args):
        self.D = np.array(*args)
        return

    def __str__(self):
        return str([[float(a) for a in x] for x in self.D])

    def __repr__(self):
        return type(self).__name__ + ""("" + str([[float(a) for a in x] for x in self.D]) + "")""

    @staticmethod
    def loadtxt(file_name, dtype=None, comments='#', delimiter=None, converters=None, skiprows=0, usecols=None, unpack=False, ndmin=0):
        D = np.loadtxt(file_name, dtype, comments, delimiter, converters, skiprows, usecols, unpack, ndmin)
        return DistanceMatrix(D)

    def savetxt(self, output_file, fmt='%.18e', delimiter=' ', newline='\n', header='', footer='', comments='# '):
        np.savetxt(output_file, self.D, fmt, delimiter, newline, header, footer, comments)
        return

    def nr_leaves(self):
        return len(self.D)

    def limb_length(self, j):
        n = self.nr_leaves()
        assert(j < n)
        minimum = sys.maxsize
        for i in range(n):
            if i != j:
                for k in range(n):
                    if k != j:
                        # next 3 lines are shuffled
                        Dik = self.D[i][k]
                        Djk = self.D[j][k]
                        Dij = self.D[i][j]
                        minimum = min([minimum, (Dij+Djk-Dik)/2])
        return minimum

    def additive_phylogeny(self):
        self.node_count = self.nr_leaves()
        return self.additive_phylogeny_rec(self, self.nr_leaves())

    def find_i_n_k(self, n):
        for i in range(n-1):
            for k in range(n-1):
                if i != k:
                    if self.D[i][k] == self.D[i][n-1] + self.D[n-1][k]:
                        return (i, n, k)
        return ""nop""

    def additive_phylogeny_rec(self, D, n):
        if n == 3:
            ll1 = (D.D[0][1] + D.D[1][2] - D.D[0][2])/2
            ll2 = D.D[1][2] - ll1
            ll0 = D.D[0][1] - ll1
            edges = {(0, self.node_count, ll0), (1, self.node_count, ll1), (2, self.node_count, ll2)}
            self.node_count += 1
            return UnrootedTree(*edges)

        ll = D.limb_length(n-1)
        D_bald = DistanceMatrix(D.D[:])
        for x in range(n-1):
            # next two lines are switched
            D_bald.D[x][n-1] -= ll
            D_bald.D[n-1][x] -= ll

        i,n,k = D_bald.find_i_n_k(n)
        x = D_bald.D[i][n-1]
        trimmed_D = DistanceMatrix([[D_bald.D[a][b] for a in range(n-1)] for b in range(n-1)])
        T = self.additive_phylogeny_rec(trimmed_D, n-1)
        path = T.path(i,k)
        i = 1
        while i < len(path) -1 and T.distance(path[0],path[i]) < x:
            i += 1

        if i is not 0 and  T.distance(path[0],path[i]) == x:
            T.add_edge(path[i-1],n-1,ll)
        else:
            a,b = path[i-1],path[i]
            new_d = D.D[path[0]][b] - x if b < len(D.D) else T.distance(path[0],b) - x
            T.add_edge(self.node_count, b, new_d)
            T.add_edge(a, self.node_count, T.distance(a,b) - new_d)
            T.add_edge(n-1, self.node_count, ll)
            T.remove_edge(a, b)
            self.node_count += 1

        return T

    def UPGMA(self):
        self.nr_count = self.nr_leaves()
        clusters = [{i} for i in range(self.nr_leaves())]
        trees = [Tree(i) for i in range(self.nr_leaves())]
        ages = [0 for _ in range(self.nr_leaves())]
        while len(clusters) > 1:
            min_d = sys.maxsize
            min_C1, min_C2 = None, None
            n = len(clusters)
            for i in range(n):
                for j in range(i+1,n):
                    C1, C2 = clusters[i], clusters[j]
                    d = self.pairwise_distance(C1,C2)
                    if d < min_d:
                        min_d = d
                        min_C1, min_C2 = C1, C2

            C1_index, C2_index = clusters.index(min_C1), clusters.index(min_C2)
            age = min_d/2
            clusters[C1_index] = min_C1 | min_C2
            clusters.pop(C2_index)
            trees[C1_index] = Tree(self.nr_count, (trees[C1_index], age - ages[C1_index]), (trees[C2_index], age - ages[C2_index] ))
            trees.pop(C2_index)
            ages[C1_index] = age
            ages.pop(C2_index)
            self.nr_count += 1
        return trees[0]

    def pairwise_distance(self,C1, C2):
        n, m = len(C1), len(C2)
        s = sum([self.D[i][j] for i in C1 for j in C2])
        return s/(n*m)

class UnrootedTree:
    def __init__(self, *edges):
        self.edges = list()
        for edge in edges:
            a,b,c = edge
            a, b, c = int(a), int(b), float(c)
            self.edges.append((a,b,c))
        d = dict()
        for edge in self.edges:
            x, y, w = edge
            #next two lines are switched
            d[(y, x)] = w
            d[(x, y)] = w
        self.d = d
        nb = defaultdict(list)
        for edge in self.edges:
            x, y, w = edge
            # next two lines are switched
            nb[y].append(x)
            nb[x].append(y)
        self.nb = nb

    def __str__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def __repr__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def add_edge(self, a,b,w):
        self.edges.append((a,b,w))
        self.d[(a,b)] = w
        self.d[(b,a)] = w
        self.nb[a].append(b)
        self.nb[b].append(a)

    def remove_edge(self,a,b):
        for edge in self.edges:
            x,y,w = edge
            if (x == a and b == y) or (x == b and y == a):
                self.edges.remove(edge)
                break
        # deletion order is switched
        del self.d[(b,a)]
        del self.d[(a,b)]
        self.nb[b].remove(a)
        self.nb[a].remove(b)

    @staticmethod
    def loadtxt(input_file):
        edges = list()
        f = open(input_file)
        for line in f:
            line = line.rstrip().split("":"")
            line[0] = line[0].split(""<->"")
            edges.append((line[0][0],line[0][1],line[1]))

        return UnrootedTree(*edges)

    def path(self, i, j):
        self.visited = [i]
        p = self.path_dfs(self.nb, i, j, [i])
        if p[0] != i:
            p = p [::-1]
        return p

    def distance(self, i,j):
        if (i,j) in self.d:
            return self.d[(i,j)]
        else:
            path = self.path(i,j)
            return self.path_weight(path)

    def path_dfs(self, graph, current_i, j, current_path):
        nb = graph[current_i]
        for n in nb:
            if n not in self.visited:
                self.visited.append(n)
                if n == j:
                    return current_path + [j]
                else:
                    r = self.path_dfs(graph, n, j, current_path + [n])
                    if r:
                        return r

    def nr_leaf_nodes(self):
        s = set()
        for edge in self.edges:
            x,y,w = edge
            #these two if cases have been switched
            if len(self.nb[y]) == 1:
                s.add(y)
            if len(self.nb[x]) == 1:
                s.add(x)
        return len(s)

    def path_weight(self, path):
        s = 0
        for i in range(len(path) -1):
            s += self.d[(path[i],path[i+1])]
        return s

    def distance_matrix(self):
        n = self.nr_leaf_nodes()
        D = [[0 for _ in range(n)] for _ in range(n)]
        self.path_weight(self.path(0,2))
        for i in range(n):
            for j in range(i+1,n):
                path = self.path(i,j)
                w = self.path_weight(path)
        D[i][j], D[j][i] = w, w
        return DistanceMatrix(D)

class Tree:
    def __init__(self, root, *subtrees):
        self.root = root
        self.subtrees = subtrees

    def __str__(self):
        subtrees_str = "", "".join([str(tree) for tree in self.subtrees])
        return type(self).__name__ + ""("" + str(self.root) + ("", "" if len(self.subtrees) > 0 else """") + subtrees_str + "")""

    def __repr__(self):
        return self.__str__()
",(program (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR (identifier) (identifier)) (identifier) (parenthesized_expression (binary_expression (identifier) (ERROR) (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (ERROR) (identifier))))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (binary_expression (binary_expression (binary_expression (member_expression (call_expression (identifier) (arguments (identifier))) (property_identifier)) (string)) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (string))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier)))) (expression_statement (identifier)) (expression_statement (call_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string (escape_sequence))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)))) (ERROR (identifier)) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (call_expression (identifier) (arguments (binary_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (member_expression (identifier) (property_identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (binary_expression (identifier) (identifier)) (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (binary_expression (identifier) (ERROR (identifier) (ERROR) (identifier) (number) (identifier) (identifier)) (identifier))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (identifier) (identifier)) (identifier))) (number))))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier))))) (return_statement (parenthesized_expression (sequence_expression (identifier) (sequence_expression (identifier) (identifier))))) (return_statement (string)) (expression_statement (identifier)) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier) (identifier) (identifier))) (ERROR (identifier)) (ERROR (number)) (assignment_expression (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)))) (number))))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (sequence_expression (assignment_expression (identifier) (ERROR) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))) (sequence_expression (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier)))) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (ERROR) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (call_expression (identifier) (arguments (ERROR) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)) (ERROR))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)))) (ERROR) (identifier) (identifier) (identifier) (identifier)) (identifier))) (expression_statement (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (identifier))) (expression_statement (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier)) (identifier))) (expression_statement (sequence_expression (identifier) (sequence_expression (identifier) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier))))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (number))) (ERROR) (expression_statement (binary_expression (binary_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number) (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))))) (ERROR (identifier)) (augmented_assignment_expression (identifier) (number)))) (ERROR (identifier) (identifier) (identifier) (number)) (expression_statement (binary_expression (call_expression (member_expression (identifier) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))) (ERROR (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (binary_expression (identifier) (number))) (binary_expression (identifier) (number)) (identifier))))) (labeled_statement (statement_identifier) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (binary_expression (identifier) (number)))) (subscript_expression (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (subscript_expression (identifier) (number))) (identifier)) (identifier)) (ERROR (identifier)) (binary_expression (call_expression (member_expression (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (identifier) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (binary_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)) (member_expression (identifier) (property_identifier)) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (assignment_expression (identifier) (array (binary_expression (object (shorthand_property_identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (ERROR (number)) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number)) (assignment_expression (identifier) (member_expression (identifier) (property_identifier))))) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (sequence_expression (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier)))) (identifier)) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR (identifier)) (expression_statement (call_expression (jsx_self_closing_element (jsx_namespace_name (identifier) (identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier))) (arguments (binary_expression (identifier) (identifier))))) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (number) (identifier) (number) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)))
13,samples/python/benchmark_files/UPGMA_A.py,"from collections import defaultdict

import numpy as np
import sys

class DistanceMatrix:
    def __init__(self, *args):
        self.D = np.array(*args)
        return

    def __str__(self):
        return str([[float(a) for a in x] for x in self.D])

    def __repr__(self):
        return type(self).__name__ + ""("" + str([[float(a) for a in x] for x in self.D]) + "")""

    @staticmethod
    def loadtxt(file_name, dtype=None,F comments='#', delimiter=None, converters=None, skiprows=0, usecols=None, unpack=False, ndmin=0):
        D = np.loadtxt(file_name, dtype, comments, delimiter, converters, skiprows, usecols, unpack, ndmin)
        return DistanceMatrix(D)

    def savetxt(self, output_file, fmt='%.18e', delimiter=' ', newline='\n', header='', footer='', comments='# '):
        np.savetxt(output_file, self.D, fmt, delimiter, newline, header, footer, comments)
        return

    def nr_leaves(self):
        return len(self.D)

    def limb_length(self, j):
        n = self.nr_leaves()
        assert(j < n)
        minimum = sys.maxsize
        for i in range(n):
            if i != j:
                for k in range(n):
                    if k != j:
                        Dij = self.D[i][j]
                        Djk = self.D[j][k]
                        Dik = self.D[i][k]
                        minimum = min([minimum, (Dij+Djk-Dik)/2])
        return minimum

    def additive_phylogeny(self):
        self.node_count = self.nr_leaves()
        return self.additive_phylogeny_rec(self, self.nr_leaves())

    def find_i_n_k(self, n):
        for i in range(n-1):
            for k in range(n-1):
                if i != k:
                    if self.D[i][k] == self.D[i][n-1] + self.D[n-1][k]:
                        return (i, n, k)
        return ""nop""

    def additive_phylogeny_rec(self, D, n):
        if n == 3:
            ll1 = (D.D[0][1] + D.D[1][2] - D.D[0][2])/2
            ll2 = D.D[1][2] - ll1
            ll0 = D.D[0][1] - ll1
            edges = {(0, self.node_count, ll0), (1, self.node_count, ll1), (2, self.node_count, ll2)}
            self.node_count += 1
            return UnrootedTree(*edges)

        ll = D.limb_length(n-1)
        D_bald = DistanceMatrix(D.D[:])
        for x in range(n-1):
            D_bald.D[n-1][x] -= ll
            D_bald.D[x][n-1] -= ll

        i,n,k = D_bald.find_i_n_k(n)
        x = D_bald.D[i][n-1]
        trimmed_D = DistanceMatrix([[D_bald.D[a][b] for a in range(n-1)] for b in range(n-1)])
        T = self.additive_phylogeny_rec(trimmed_D, n-1)
        path = T.path(i,k)
        i = 1
        while i < len(path) -1 and T.distance(path[0],path[i]) < x:
            i += 1

        if i is not 0 and  T.distance(path[0],path[i]) == x:
            T.add_edge(path[i-1],n-1,ll)
        else:
            a,b = path[i-1],path[i]
            new_d = D.D[path[0]][b] - x if b < len(D.D) else T.distance(path[0],b) - x
            T.add_edge(self.node_count, b, new_d)
            T.add_edge(a, self.node_count, T.distance(a,b) - new_d)
            T.add_edge(n-1, self.node_count, ll)
            T.remove_edge(a, b)
            self.node_count += 1

        return T

    def UPGMA(self):
        self.nr_count = self.nr_leaves()
        clusters = [{i} for i in range(self.nr_leaves())]
        trees = [Tree(i) for i in range(self.nr_leaves())]
        ages = [0 for _ in range(self.nr_leaves())]
        while len(clusters) > 1:
            min_d = sys.maxsize
            min_C1, min_C2 = None, None
            n = len(clusters)
            for i in range(n):
                for j in range(i+1,n):
                    C1, C2 = clusters[i], clusters[j]
                    d = self.pairwise_distance(C1,C2)
                    if d < min_d:
                        min_d = d
                        min_C1, min_C2 = C1, C2

            C1_index, C2_index = clusters.index(min_C1), clusters.index(min_C2)
            age = min_d/2
            clusters[C1_index] = min_C1 | min_C2
            clusters.pop(C2_index)
            trees[C1_index] = Tree(self.nr_count, (trees[C1_index], age - ages[C1_index]), (trees[C2_index], age - ages[C2_index] ))
            trees.pop(C2_index)
            ages[C1_index] = age
            ages.pop(C2_index)
            self.nr_count += 1
        return trees[0]

    def pairwise_distance(self,C1, C2):
        n, m = len(C1), len(C2)
        s = sum([self.D[i][j] for i in C1 for j in C2])
        return s/(n*m)

class UnrootedTree:
    def __init__(self, *edges):
        self.edges = list()
        for edge in edges:
            a,b,c = edge
            a, b, c = int(a), int(b), float(c)
            self.edges.append((a,b,c))
        d = dict()
        for edge in self.edges:
            x, y, w = edge
            d[(x, y)] = w
            d[(y, x)] = w
        self.d = d
        nb = defaultdict(list)
        for edge in self.edges:
            x, y, w = edge
            nb[x].append(y)
            nb[y].append(x)
        self.nb = nb

    def __str__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def __repr__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def add_edge(self, a,b,w):
        self.edges.append((a,b,w))
        self.d[(a,b)] = w
        self.d[(b,a)] = w
        self.nb[a].append(b)
        self.nb[b].append(a)

    def remove_edge(self,a,b):
        for edge in self.edges:
            x,y,w = edge
            if (x == a and b == y) or (x == b and y == a):
                self.edges.remove(edge)
                break
        del self.d[(a,b)]
        del self.d[(b,a)]
        self.nb[a].remove(b)
        self.nb[b].remove(a)

    @staticmethod
    def loadtxt(input_file):
        edges = list()
        f = open(input_file)
        for line in f:
            line = line.rstrip().split("":"")
            line[0] = line[0].split(""<->"")
            edges.append((line[0][0],line[0][1],line[1]))

        return UnrootedTree(*edges)

    def path(self, i, j):
        self.visited = [i]
        p = self.path_dfs(self.nb, i, j, [i])
        if p[0] != i:
            p = p [::-1]
        return p

    def distance(self, i,j):
        if (i,j) in self.d:
            return self.d[(i,j)]
        else:
            path = self.path(i,j)
            return self.path_weight(path)

    def path_dfs(self, graph, current_i, j, current_path):
        nb = graph[current_i]
        for n in nb:
            if n not in self.visited:
                self.visited.append(n)
                if n == j:
                    return current_path + [j]
                else:
                    r = self.path_dfs(graph, n, j, current_path + [n])
                    if r:
                        return r

    def nr_leaf_nodes(self):
        s = set()
        for edge in self.edges:
            x,y,w = edge
            if len(self.nb[x]) == 1:
                s.add(x)
            if len(self.nb[y]) == 1:
                s.add(y)
        return len(s)

    def path_weight(self, path):
        s = 0
        for i in range(len(path) -1):
            s += self.d[(path[i],path[i+1])]
        return s

    def distance_matrix(self):
        n = self.nr_leaf_nodes()
        D = [[0 for _ in range(n)] for _ in range(n)]
        self.path_weight(self.path(0,2))
        for i in range(n):
            for j in range(i+1,n):
                path = self.path(i,j)
                w = self.path_weight(path)
        D[i][j], D[j][i] = w, w
        return DistanceMatrix(D)

class Tree:
    def __init__(self, root, *subtrees):
        self.root = root
        self.subtrees = subtrees

    def __str__(self):
        subtrees_str = "", "".join([str(tree) for tree in self.subtrees])
        return type(self).__name__ + ""("" + str(self.root) + ("", "" if len(self.subtrees) > 0 else """") + subtrees_str + "")""

    def __repr__(self):
        return self.__str__()
",(program (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR (identifier) (identifier)) (identifier) (parenthesized_expression (binary_expression (identifier) (ERROR) (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (ERROR) (identifier))))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (binary_expression (binary_expression (binary_expression (member_expression (call_expression (identifier) (arguments (identifier))) (property_identifier)) (string)) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (string))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (assignment_expression (identifier) (identifier)) (ERROR (identifier)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier)))) (expression_statement (identifier)) (expression_statement (call_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string (escape_sequence))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)))) (ERROR (identifier)) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (call_expression (identifier) (arguments (binary_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (member_expression (identifier) (property_identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (binary_expression (identifier) (identifier)) (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (identifier) (identifier)) (identifier))) (number))))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier))))) (return_statement (parenthesized_expression (sequence_expression (identifier) (sequence_expression (identifier) (identifier))))) (return_statement (string)) (expression_statement (identifier)) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier) (identifier) (identifier))) (ERROR (identifier)) (ERROR (number)) (assignment_expression (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)))) (number))))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (sequence_expression (assignment_expression (identifier) (ERROR) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))) (sequence_expression (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier)))) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (ERROR) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (call_expression (identifier) (arguments (ERROR) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)) (ERROR))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier)) (identifier)))) (expression_statement (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (identifier))) (expression_statement (sequence_expression (identifier) (sequence_expression (identifier) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier))))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (number))) (ERROR) (expression_statement (binary_expression (binary_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number) (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))))) (ERROR (identifier)) (augmented_assignment_expression (identifier) (number)))) (ERROR (identifier) (identifier) (identifier) (number)) (expression_statement (binary_expression (call_expression (member_expression (identifier) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))) (ERROR (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (binary_expression (identifier) (number))) (binary_expression (identifier) (number)) (identifier))))) (labeled_statement (statement_identifier) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (binary_expression (identifier) (number)))) (subscript_expression (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (subscript_expression (identifier) (number))) (identifier)) (identifier)) (ERROR (identifier)) (binary_expression (call_expression (member_expression (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (identifier) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (binary_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)) (member_expression (identifier) (property_identifier)) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (assignment_expression (identifier) (array (binary_expression (object (shorthand_property_identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (ERROR (number)) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number)) (assignment_expression (identifier) (member_expression (identifier) (property_identifier))))) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (sequence_expression (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier)))) (identifier)) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR (identifier)) (expression_statement (call_expression (jsx_self_closing_element (jsx_namespace_name (identifier) (identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier))) (arguments (binary_expression (identifier) (identifier))))) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (number) (identifier) (number) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)))
14,samples/python/benchmark_files/UPGMA_A_variablenames.py,"from collections import defaultdict

import numpy as np
import sys

class DistanceMatrix:
    def __init__(self, *args):
        self.distances = np.array(*args)
        return

    def __str__(self):
        return str([[float(a) for a in x] for x in self.distances])

    def __repr__(self):
        return type(self).__name__ + ""("" + str([[float(a) for a in x] for x in self.distances]) + "")""

    @staticmethod
    def loadtxt(file_name, dtype=None, comments='#', delimiter=None, converters=None, skiprows=0, usecols=None, unpack=False, ndmin=0):
        distances = np.loadtxt(file_name, dtype, comments, delimiter, converters, skiprows, usecols, unpack, ndmin)
        return DistanceMatrix(distances)

    def savetxt(self, output_file, fmt='%.18e', delimiter=' ', newline='\n', header='', footer='', comments='# '):
        np.savetxt(output_file, self.distances, fmt, delimiter, newline, header, footer, comments)
        return

    def nr_leaves(self):
        return len(self.distances)

    def limb_length(self, j):
        n = self.nr_leaves()
        assert(j < n)
        minimum = sys.maxsize
        for i in range(n):
            if i != j:
                for k in range(n):
                    if k != j:
                        distances_ij = self.distances[i][j]
                        distances_jk = self.distances[j][k]
                        distances_ik = self.distances[i][k]
                        minimum = min([minimum, (distances_ij+distances_jk-distances_ik)/2])
        return minimum

    def additive_phylogeny(self):
        self.node_count = self.nr_leaves()
        return self.additive_phylogeny_rec(self, self.nr_leaves())

    def find_i_n_k(self, n):
        for i in range(n-1):
            for k in range(n-1):
                if i != k:
                    if self.distances[i][k] == self.distances[i][n-1] + self.distances[n-1][k]:
                        return (i, n, k)
        return ""nop""

    def additive_phylogeny_rec(self, distances, n):
        if n == 3:
            ll1 = (distances.distances[0][1] + distances.distances[1][2] - distances.distances[0][2])/2
            ll2 = distances.distances[1][2] - ll1
            ll0 = distances.distances[0][1] - ll1
            edges = {(0, self.node_count, ll0), (1, self.node_count, ll1), (2, self.node_count, ll2)}
            self.node_count += 1
            return UnrootedTree(*edges)

        ll = distances.limb_length(n-1)
        distances_bald = DistanceMatrix(distances.distances[:])
        for x in range(n-1):
            distances_bald.distances[n-1][x] -= ll
            distances_bald.distances[x][n-1] -= ll

        i,n,k = distances_bald.find_i_n_k(n)
        x = distances_bald.distances[i][n-1]
        trimmed_distances = DistanceMatrix([[distances_bald.distances[a][b] for a in range(n-1)] for b in range(n-1)])
        T = self.additive_phylogeny_rec(trimmed_distances, n-1)
        path = T.path(i,k)
        i = 1
        while i < len(path) -1 and T.distance(path[0],path[i]) < x:
            i += 1

        if i is not 0 and  T.distance(path[0],path[i]) == x:
            T.add_edge(path[i-1],n-1,ll)
        else:
            a,b = path[i-1],path[i]
            new_d = distances.distances[path[0]][b] - x if b < len(distances.distances) else T.distance(path[0],b) - x
            T.add_edge(self.node_count, b, new_d)
            T.add_edge(a, self.node_count, T.distance(a,b) - new_d)
            T.add_edge(n-1, self.node_count, ll)
            T.remove_edge(a, b)
            self.node_count += 1

        return T

    def UPGMA(self):
        self.nr_count = self.nr_leaves()
        clusters = [{i} for i in range(self.nr_leaves())]
        trees = [Tree(i) for i in range(self.nr_leaves())]
        ages = [0 for _ in range(self.nr_leaves())]
        while len(clusters) > 1:
            min_d = sys.maxsize
            min_C1, min_C2 = None, None
            n = len(clusters)
            for i in range(n):
                for j in range(i+1,n):
                    C1, C2 = clusters[i], clusters[j]
                    d = self.pairwise_distance(C1,C2)
                    if d < min_d:
                        min_d = d
                        min_C1, min_C2 = C1, C2

            C1_index, C2_index = clusters.index(min_C1), clusters.index(min_C2)
            age = min_d/2
            clusters[C1_index] = min_C1 | min_C2
            clusters.pop(C2_index)
            trees[C1_index] = Tree(self.nr_count, (trees[C1_index], age - ages[C1_index]), (trees[C2_index], age - ages[C2_index] ))
            trees.pop(C2_index)
            ages[C1_index] = age
            ages.pop(C2_index)
            self.nr_count += 1
        return trees[0]

    def pairwise_distance(self,C1, C2):
        n, m = len(C1), len(C2)
        s = sum([self.distances[i][j] for i in C1 for j in C2])
        return s/(n*m)

class UnrootedTree:
    def __init__(self, *edges):
        self.edges = list()
        for edge in edges:
            a,b,c = edge
            a, b, c = int(a), int(b), float(c)
            self.edges.append((a,b,c))
        d = dict()
        for edge in self.edges:
            x, y, w = edge
            d[(x, y)] = w
            d[(y, x)] = w
        self.distances = d
        nb = defaultdict(list)
        for edge in self.edges:
            x, y, w = edge
            nb[x].append(y)
            nb[y].append(x)
        self.nb = nb

    def __str__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def __repr__(self):
        return type(self).__name__ + str(tuple(self.edges))

    def add_edge(self, a,b,w):
        self.edges.append((a,b,w))
        self.distances[(a,b)] = w
        self.distances[(b,a)] = w
        self.nb[a].append(b)
        self.nb[b].append(a)

    def remove_edge(self,a,b):
        for edge in self.edges:
            x,y,w = edge
            if (x == a and b == y) or (x == b and y == a):
                self.edges.remove(edge)
                break
        del self.distances[(a,b)]
        del self.distances[(b,a)]
        self.nb[a].remove(b)
        self.nb[b].remove(a)

    @staticmethod
    def loadtxt(input_file):
        edges = list()
        f = open(input_file)
        for line in f:
            line = line.rstrip().split("":"")
            line[0] = line[0].split(""<->"")
            edges.append((line[0][0],line[0][1],line[1]))

        return UnrootedTree(*edges)

    def path(self, i, j):
        self.visited = [i]
        p = self.path_dfs(self.nb, i, j, [i])
        if p[0] != i:
            p = p [::-1]
        return p

    def distance(self, i,j):
        if (i,j) in self.distances:
            return self.distances[(i,j)]
        else:
            path = self.path(i,j)
            return self.path_weight(path)

    def path_dfs(self, graph, current_i, j, current_path):
        nb = graph[current_i]
        for n in nb:
            if n not in self.visited:
                self.visited.append(n)
                if n == j:
                    return current_path + [j]
                else:
                    r = self.path_dfs(graph, n, j, current_path + [n])
                    if r:
                        return r

    def nr_leaf_nodes(self):
        s = set()
        for edge in self.edges:
            x,y,w = edge
            if len(self.nb[x]) == 1:
                s.add(x)
            if len(self.nb[y]) == 1:
                s.add(y)
        return len(s)

    def path_weight(self, path):
        s = 0
        for i in range(len(path) -1):
            s += self.distances[(path[i],path[i+1])]
        return s

    def distance_matrix(self):
        n = self.nr_leaf_nodes()
        distances = [[0 for _ in range(n)] for _ in range(n)]
        self.path_weight(self.path(0,2))
        for i in range(n):
            for j in range(i+1,n):
                path = self.path(i,j)
                w = self.path_weight(path)
        distances[i][j], distances[j][i] = w, w
        return DistanceMatrix(distances)

class Tree:
    def __init__(self, root, *subtrees):
        self.root = root
        self.subtrees = subtrees

    def __str__(self):
        subtrees_str = "", "".join([str(tree) for tree in self.subtrees])
        return type(self).__name__ + ""("" + str(self.root) + ("", "" if len(self.subtrees) > 0 else """") + subtrees_str + "")""

    def __repr__(self):
        return self.__str__()
",(program (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (ERROR (identifier) (identifier)) (identifier) (parenthesized_expression (binary_expression (identifier) (ERROR) (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (ERROR) (identifier))))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (binary_expression (binary_expression (binary_expression (member_expression (call_expression (identifier) (arguments (identifier))) (property_identifier)) (string)) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (identifier))) (ERROR (identifier)) (member_expression (identifier) (property_identifier))))))) (string))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier)))) (expression_statement (identifier)) (expression_statement (call_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string (escape_sequence))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)))) (ERROR (identifier)) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)))) (return_statement) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (call_expression (identifier) (arguments (binary_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (member_expression (identifier) (property_identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (binary_expression (identifier) (identifier)) (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (identifier) (identifier)) (identifier))) (number))))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (binary_expression (identifier) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier))))) (return_statement (parenthesized_expression (sequence_expression (identifier) (sequence_expression (identifier) (identifier))))) (return_statement (string)) (expression_statement (identifier)) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier) (identifier) (identifier))) (ERROR (identifier)) (ERROR (number)) (assignment_expression (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number))) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)))) (number))))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (number)) (number)) (identifier)))) (expression_statement (sequence_expression (assignment_expression (identifier) (ERROR) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))) (sequence_expression (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier)))) (parenthesized_expression (sequence_expression (number) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (ERROR) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (call_expression (identifier) (arguments (ERROR) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)) (ERROR))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (binary_expression (identifier) (number))) (identifier)) (identifier)))) (expression_statement (augmented_assignment_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))) (identifier))) (expression_statement (sequence_expression (identifier) (sequence_expression (identifier) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier))))))) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (array (binary_expression (array (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))) (ERROR (identifier)) (call_expression (identifier) (arguments (binary_expression (identifier) (number)))))))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (number))) (ERROR) (expression_statement (binary_expression (binary_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number) (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))))) (ERROR (identifier)) (augmented_assignment_expression (identifier) (number)))) (ERROR (identifier) (identifier) (identifier) (number)) (expression_statement (binary_expression (call_expression (member_expression (identifier) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (subscript_expression (identifier) (identifier)))) (ERROR (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (binary_expression (identifier) (number))) (binary_expression (identifier) (number)) (identifier))))) (labeled_statement (statement_identifier) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (binary_expression (identifier) (number)))) (subscript_expression (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (binary_expression (binary_expression (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (subscript_expression (identifier) (number))) (identifier)) (identifier)) (ERROR (identifier)) (binary_expression (call_expression (member_expression (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))) (ERROR (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (number)) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (identifier) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (binary_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))) (identifier))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (binary_expression (identifier) (number)) (member_expression (identifier) (property_identifier)) (identifier)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (assignment_expression (identifier) (array (binary_expression (object (shorthand_property_identifier)) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (identifier)) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (expression_statement (assignment_expression (identifier) (array (ERROR (number)) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number)) (assignment_expression (identifier) (member_expression (identifier) (property_identifier))))) (expression_statement (sequence_expression (identifier) (sequence_expression (assignment_expression (identifier) (identifier)) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (sequence_expression (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier)))) (identifier)) (sequence_expression (assignment_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR (identifier)) (expression_statement (call_expression (jsx_self_closing_element (jsx_namespace_name (identifier) (identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (ERROR (number)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (jsx_namespace_name (identifier) (ERROR) (identifier))) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (jsx_attribute (property_identifier)) (ERROR) (jsx_attribute (property_identifier))) (arguments (binary_expression (identifier) (identifier))))) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (number) (identifier) (number) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)))
15,samples/python/benchmark_files/UPGMA_B.py,"import numpy as np
from collections import defaultdict
from math import inf

class DistanceMatrix:

    def __init__(self, object, dtype=None, copy=True, order='K', subok=False, ndmin=0):
        self.matrix = np.array(object, dtype=dtype, copy=copy, order=order, subok=subok, ndmin=ndmin)
        self.max_node = len(self.matrix)
        is_symmetric = np.allclose(self.matrix, self.matrix.T, atol=1e-8)
        is_all_positive = self.matrix.min() >= 0
        diagonal_is_zero = np.count_nonzero(np.diagonal(self.matrix)) == 0
        if not is_symmetric or not is_all_positive or not diagonal_is_zero:
            raise ValueError(""invalid distance matrix"")

    @staticmethod
    def loadtxt(fname, dtype=np.float, comments='#', delimiter=None, converters=None, skiprows=0, usecols=None, unpack=False, ndmin=0):
        matrix = np.loadtxt(fname, dtype, comments, delimiter, converters, skiprows, usecols, unpack, ndmin)
        return DistanceMatrix(matrix, dtype, ndmin=ndmin)

    def savetxt(self, fname, fmt='%.18e', delimiter=' ', newline='\n', header='', footer='', comments='# '):
        np.savetxt(fname, self.matrix, fmt, delimiter, newline, header, footer, comments)

    def limb_length(self, j):
        return DistanceMatrix.limb_length_from_matrix(self.matrix, j)

    @staticmethod
    def limb_length_from_matrix(mat, j):
        n = len(mat)
        min_length = inf
        for i in range(n):
            for k in range(i + 1, n):
                if i != j and k != j:
                    length = (mat[i][j] + mat[j][k] - mat[i][k]) / 2
                    if length < min_length:
                        min_length = length
        return min_length

    def additive_phylogeny(self):
        self.max_node = len(self.matrix)
        return UnrootedTree(*sorted(self.additive_phylogeny_recursive(self.matrix, len(self.matrix))))

    def additive_phylogeny_recursive(self, mat, n):
        if n == 2:
            return [(0, 1, mat[0][1])]
        limb_size = DistanceMatrix.limb_length_from_matrix(mat[:n, :n], n - 1)
        for j in range(n - 1):
            mat[n - 1][j] = mat[n - 1][j] - limb_size
            mat[j][n - 1] = mat[n - 1][j]
        for i in range(n - 1):
            found = False
            for k in range(i, n - 1):
                if mat[i][k] == mat[i][n - 1] + mat[k][n - 1]:
                    found = True
                    break
            if found:
                break
        x = mat[i][n - 1]
        tree_list = self.additive_phylogeny_recursive(mat.copy(), n - 1)
        tree = UnrootedTree(*tree_list)
        path = tree.path(i, k)
        for j in range(1, len(path)):
            edge = (path[j - 1], path[j])
            edge_sorted = tuple(sorted(edge))
            if tree.edges[edge_sorted] > x:
                tree_list.remove((edge_sorted[0], edge_sorted[1], tree.edges[edge_sorted]))
                tree_list.append((edge[0], self.max_node, x))
                tree_list.append((edge[1], self.max_node, tree.edges[edge_sorted] - x))
                tree_list.append((n - 1, self.max_node, limb_size))
                self.max_node += 1
                break
            elif tree.edges[edge_sorted] == x:
                new_edge = sorted((n - 1, edge[1]))
                tree_list.append((new_edge[0], new_edge[1], limb_size))
                break
            else:
                x -= tree.edges[edge_sorted]

        return tree_list

    def UPGMA(self):
        clusters = dict()
        cluster_mapping = dict()
        trees = dict()
        ages = dict()
        mat = self.matrix.copy()
        for i in range(len(self.matrix)):
            clusters[i] = set([i])
            cluster_mapping[i] = i
            trees[i] = Tree(i)
            ages[i] = 0
        self.max_node = len(self.matrix)

        while len(clusters) > 1:
            closest_clusters_distance = inf
            for i in clusters.keys():
                for j in clusters.keys():
                    if i != j:
                        dist = mat[cluster_mapping[i]][cluster_mapping[j]]
                        if dist < closest_clusters_distance:
                            closest_clusters = (i, j)
                            closest_clusters_distance = dist

            i, j = closest_clusters

            new_cluster = clusters[i].union(clusters[j])
            new_tree = Tree(self.max_node, (trees[i], 0), (trees[j], 0))
            del trees[i]
            del trees[j]
            trees[self.max_node] = new_tree
            ages[self.max_node] = closest_clusters_distance / 2
            cluster_mapping[self.max_node] = cluster_mapping[i]
            del cluster_mapping[i]
            del cluster_mapping[j]
            del clusters[i]
            del clusters[j]
            clusters[self.max_node] = new_cluster

            for i, cluster in clusters.items():
                if i != self.max_node:
                    distance = self.get_cluster_distance(new_cluster, cluster)
                    mat[cluster_mapping[self.max_node]][cluster_mapping[i]] = distance
                    mat[cluster_mapping[i]][cluster_mapping[self.max_node]] = distance

            self.max_node += 1

        root = list(trees.values())[0]
        DistanceMatrix.set_age(ages, root)
        return root

    @staticmethod
    def set_age(ages, node):
        for child in node.children.keys():
            node.children[child] = ages[node.label] - ages[child.label]
            if child.children:
                DistanceMatrix.set_age(ages, child)

    def get_cluster_distance(self, c1, c2):
        distance = 0
        for i in c1:
            for j in c2:
                distance += self.matrix[i][j]
        distance /= len(c1) * len(c2)
        return distance

    def __repr__(self):
        return ""DistanceMatrix("" + str(self) + "")""

    def __str__(self):
        mat_string = ""[""
        for row in self.matrix:
            mat_string += ""[""
            for val in row:
                mat_string += str(val) + "", ""
            mat_string = mat_string[:-2] + ""], ""
        mat_string = mat_string[:-2] + ""]""
        return mat_string

class UnrootedTree:

    def __init__(self, *args):
        self.graph = defaultdict(set)
        self.edges = defaultdict(int)
        self.nodes = set()
        self.edges_list = list()
        self.leaves = set()
        for tup in args:
            self.graph[tup[0]].add((tup[1]))
            self.graph[tup[1]].add((tup[0]))
            self.edges[tuple(sorted((tup[0], tup[1])))] = tup[2]
            self.edges_list.append((tup[0], tup[1], float(tup[2])))
            self.nodes.add(tup[0])
            self.nodes.add(tup[1])
        for key, val in self.graph.items():
            if len(val) == 1:
                self.leaves.add(key)

    def __repr__(self):
        repr_str = ""UnrootedTree(""
        for edge in self.edges_list:
            repr_str += str(edge) + "", ""
        return repr_str[:-2] + "")""

    @staticmethod
    def loadtxt(f):
        with open(f, ""r"") as graph_file:
            tuple_list = []
            for line in graph_file:
                line_arr = line.strip().split(""<->"")
                rhs = line_arr[1].split("":"")
                tuple_list.append((int(line_arr[0]), int(rhs[0]), float(rhs[1])))
            return UnrootedTree(*tuple_list)

    def path(self, first_node, second_node):
        stack = [(first_node, [first_node])]
        while stack:
            (vertex, path) = stack.pop()
            for next_vertex in self.graph[vertex] - set(path):
                if next_vertex == second_node:
                    return path + [next_vertex]
                else:
                    stack.append((next_vertex, path + [next_vertex]))

    def distance_matrix(self):
        mat = [[0 for _ in range(len(self.leaves))] for _ in range(len(self.leaves))]
        for n1 in self.leaves:
            for n2 in self.leaves:
                if n1 < n2:
                    path = self.path(n1, n2)
                    length = 0
                    for i in range(1, len(path)):
                        length += self.edges[tuple(sorted((path[i - 1], path[i])))]
                    mat[n1][n2] = length
                    mat[n2][n1] = length
        return DistanceMatrix(mat)

class Tree:

    def __init__(self, label, *args):
        self.label = label
        self.children = dict()
        for child in args:
            self.children[child[0]] = child[1]

    def __repr__(self):
        repr_str = ""Tree("" + str(self.label) + "", ""
        for child, weight in self.children.items():
            repr_str += ""("" + child.__repr__() + "", "" + str(weight) + ""), ""
        return repr_str[:-2] + "")""

if __name__ == ""__main__"":
    D = DistanceMatrix.loadtxt('distances.txt')
    print(D.UPGMA())
",(program (expression_statement (assignment_expression (member_expression (call_expression (import) (ERROR (import_clause (identifier)) (ERROR (identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)) (arguments (identifier) (identifier) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)))) (ERROR (identifier)) (property_identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)))))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (member_expression (member_expression (identifier) (property_identifier)) (property_identifier)) (assignment_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (binary_expression (call_expression (member_expression (member_expression (identifier) (property_identifier)) (property_identifier)) (arguments)) (number)))) (expression_statement (assignment_expression (identifier) (binary_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)))))) (number)))) (ERROR) (expression_statement (identifier)) (ERROR (identifier) (identifier) (identifier) (identifier) (identifier)) (expression_statement (identifier)) (labeled_statement (statement_identifier) (expression_statement (identifier))) (expression_statement (call_expression (identifier) (arguments (string)))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (assignment_expression (identifier) (member_expression (identifier) (property_identifier))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (identifier)) (assignment_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier))))) (return_statement (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (identifier))))) (expression_statement (identifier)) (expression_statement (call_expression (member_expression (call_expression (identifier) (arguments (identifier) (identifier) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string (escape_sequence))) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)) (assignment_expression (identifier) (string)))) (ERROR (identifier)) (property_identifier)) (arguments (identifier) (member_expression (identifier) (property_identifier)) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier)))) (return_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (identifier)))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (identifier))))) (expression_statement (assignment_expression (identifier) (identifier))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier)))) (binary_expression (identifier) (call_expression (identifier) (arguments (binary_expression (identifier) (number)) (identifier))))) (expression_statement (binary_expression (binary_expression (identifier) (ERROR (identifier) (identifier)) (identifier)) (ERROR (identifier)) (assignment_expression (identifier) (binary_expression (parenthesized_expression (binary_expression (binary_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (subscript_expression (subscript_expression (identifier) (identifier)) (identifier))) (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)))) (number))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (identifier)))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))))) (return_statement (call_expression (identifier) (arguments (ERROR) (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments (member_expression (identifier) (property_identifier)) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))))))))) (expression_statement (identifier)) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier) (identifier) (identifier))) (ERROR (identifier)) (subscript_expression (number) (ERROR) (parenthesized_expression (sequence_expression (number) (sequence_expression (number) (subscript_expression (subscript_expression (identifier) (number)) (number)))))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (subscript_expression (identifier) (ERROR) (sequence_expression (identifier) (ERROR) (identifier))) (binary_expression (identifier) (number)))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (assignment_expression (subscript_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (identifier)) (binary_expression (subscript_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (identifier)) (identifier))))) (expression_statement (assignment_expression (subscript_expression (subscript_expression (identifier) (identifier)) (binary_expression (identifier) (number))) (subscript_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (identifier)))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (binary_expression (identifier) (number))))) (assignment_expression (identifier) (identifier)))) (ERROR (binary_expression (identifier) (call_expression (identifier) (arguments (identifier) (binary_expression (identifier) (number)))))) (expression_statement (binary_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (binary_expression (subscript_expression (subscript_expression (identifier) (identifier)) (binary_expression (identifier) (number))) (ERROR (subscript_expression (subscript_expression (identifier) (identifier)) (binary_expression (identifier) (number)))) (assignment_expression (identifier) (identifier))))) (break_statement) (ERROR) (labeled_statement (statement_identifier) (break_statement)) (expression_statement (assignment_expression (identifier) (subscript_expression (subscript_expression (identifier) (identifier)) (binary_expression (identifier) (number))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)) (binary_expression (identifier) (number)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (ERROR) (identifier))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (number) (call_expression (identifier) (arguments (identifier)))))) (assignment_expression (identifier) (parenthesized_expression (sequence_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (subscript_expression (identifier) (identifier))))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (call_expression (identifier) (arguments (identifier))))))) (ERROR) (expression_statement (binary_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (ERROR (identifier)) (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (number)) (sequence_expression (subscript_expression (identifier) (number)) (subscript_expression (member_expression (identifier) (property_identifier)) (identifier))))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (number)) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (number)) (sequence_expression (member_expression (identifier) (property_identifier)) (binary_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier)))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (binary_expression (identifier) (number)) (sequence_expression (member_expression (identifier) (property_identifier)) (identifier))))))) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (break_statement) (expression_statement (binary_expression (subscript_expression (member_expression (identifier) (ERROR (identifier)) (property_identifier)) (identifier)) (ERROR (identifier)) (assignment_expression (identifier) (call_expression (identifier) (arguments (parenthesized_expression (sequence_expression (binary_expression (identifier) (number)) (subscript_expression (identifier) (number))))))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (number)) (sequence_expression (subscript_expression (identifier) (number)) (identifier))))))) (break_statement) (labeled_statement (statement_identifier) (expression_statement (augmented_assignment_expression (identifier) (subscript_expression (member_expression (identifier) (property_identifier)) (identifier))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments)))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (member_expression (identifier) (property_identifier)) (property_identifier)) (arguments)))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))))) (assignment_expression (subscript_expression (identifier) (identifier)) (call_expression (identifier) (arguments (array (identifier))))))) (expression_statement (assignment_expression (subscript_expression (identifier) (identifier)) (identifier))) (expression_statement (assignment_expression (subscript_expression (identifier) (identifier)) (call_expression (identifier) (arguments (identifier))))) (expression_statement (assignment_expression (subscript_expression (identifier) (identifier)) (number))) (expression_statement (assignment_expression (member_expression (identifier) (property_identifier)) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)))))) (ERROR) (expression_statement (binary_expression (call_expression (identifier) (arguments (identifier))) (ERROR (number)) (assignment_expression (identifier) (identifier)))) (ERROR (binary_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments))) (binary_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (subscript_expression (subscript_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (identifier)))))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (parenthesized_expression (sequence_expression (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (identifier))) (expression_statement (sequence_expression (identifier) (assignment_expression (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (subscript_expression (identifier) (identifier)) (property_identifier)) (arguments (subscript_expression (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier)) (parenthesized_expression (sequence_expression (subscript_expression (identifier) (identifier)) (number))) (parenthesized_expression (sequence_expression (subscript_expression (identifier) (identifier)) (number))))))) (expression_statement (subscript_expression (identifier) (ERROR (identifier)) (identifier))) (expression_statement (subscript_expression (identifier) (ERROR (identifier)) (identifier))) (expression_statement (assignment_expression (subscript_expression (identifier) (member_expression (identifier) (property_identifier))) (identifier))) (expression_statement (assignment_expression (subscript_expression (identifier) (member_expression (identifier) (property_identifier))) (binary_expression (identifier) (number)))) (expression_statement (assignment_expression (subscript_expression (identifier) (member_expression (identifier) (property_identifier))) (subscript_expression (identifier) (identifier)))) (expression_statement (identifier)) (expression_statement (subscript_expression (identifier) (identifier))) (expression_statement (identifier)) (expression_statement (subscript_expression (identifier) (identifier))) (expression_statement (identifier)) (expression_statement (subscript_expression (identifier) (identifier))) (expression_statement (identifier)) (expression_statement (subscript_expression (identifier) (identifier))) (expression_statement (assignment_expression (subscript_expression (identifier) (member_expression (identifier) (property_identifier))) (identifier))) (ERROR (sequence_expression (identifier) (binary_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (expression_statement (binary_expression (identifier) (ERROR (member_expression (identifier) (property_identifier))) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))))) (expression_statement (assignment_expression (subscript_expression (subscript_expression (identifier) (subscript_expression (identifier) (member_expression (identifier) (property_identifier)))) (subscript_expression (identifier) (identifier))) (identifier))) (expression_statement (assignment_expression (subscript_expression (subscript_expression (identifier) (subscript_expression (identifier) (identifier))) (subscript_expression (identifier) (member_expression (identifier) (property_identifier)))) (identifier))) (expression_statement (augmented_assignment_expression (member_expression (identifier) (property_identifier)) (number))) (expression_statement (assignment_expression (identifier) (subscript_expression (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments)))) (number)))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))) (return_statement (identifier)) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier) (identifier)))) (expression_statement (binary_expression (identifier) (ERROR (call_expression (member_expression (member_expression (identifier) (property_identifier)) (property_identifier)) (arguments))) (assignment_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (binary_expression (subscript_expression (identifier) (member_expression (identifier) (property_identifier))) (subscript_expression (identifier) (member_expression (identifier) (property_identifier))))))) (ERROR (member_expression (identifier) (property_identifier))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier) (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (number))) (ERROR (binary_expression (identifier) (identifier))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (augmented_assignment_expression (identifier) (subscript_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (identifier))))) (expression_statement (augmented_assignment_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (call_expression (identifier) (arguments (identifier)))))) (return_statement (identifier)) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (return_statement (binary_expression (binary_expression (string) (call_expression (identifier) (arguments (identifier)))) (string))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier)))) (expression_statement (assignment_expression (identifier) (string))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (member_expression (identifier) (property_identifier))) (augmented_assignment_expression (identifier) (string)))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (augmented_assignment_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (string))))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (identifier) (ERROR) (unary_expression (number))) (string)))) (expression_statement (assignment_expression (identifier) (binary_expression (subscript_expression (identifier) (ERROR) (unary_expression (number))) (string)))) (return_statement (identifier)) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier)) (identifier)) (expression_statement (string)) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (member_expression (identifier) (property_identifier))) (augmented_assignment_expression (identifier) (binary_expression (call_expression (identifier) (arguments (identifier))) (string))))) (return_statement (binary_expression (subscript_expression (identifier) (ERROR) (unary_expression (number))) (string))) (ERROR (decorator (identifier)) (identifier) (call_expression (identifier) (arguments (identifier))) (call_expression (identifier) (arguments (identifier) (string)))) (labeled_statement (statement_identifier) (expression_statement (assignment_expression (identifier) (array)))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (call_expression (member_expression (call_expression (member_expression (identifier) (property_identifier)) (arguments)) (property_identifier)) (arguments (string)))))) (expression_statement (assignment_expression (identifier) (call_expression (member_expression (subscript_expression (identifier) (number)) (property_identifier)) (arguments (string))))) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))) (sequence_expression (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))) (call_expression (identifier) (arguments (subscript_expression (identifier) (number)))))))))) (return_statement (call_expression (identifier) (arguments (ERROR) (identifier)))) (ERROR (call_expression (identifier) (ERROR (identifier)) (arguments (identifier) (identifier) (identifier)))) (expression_statement (assignment_expression (identifier) (array (parenthesized_expression (sequence_expression (identifier) (array (identifier))))))) (ERROR) (labeled_statement (statement_identifier) (expression_statement (assignment_expression (parenthesized_expression (sequence_expression (identifier) (identifier))) (call_expression (member_expression (identifier) (property_identifier)) (arguments))))) (ERROR (binary_expression (identifier) (binary_expression (subscript_expression (member_expression (identifier) (property_identifier)) (identifier)) (call_expression (identifier) (arguments (identifier))))) (binary_expression (identifier) (identifier))) (return_statement (binary_expression (identifier) (array (identifier)))) (labeled_statement (statement_identifier) (expression_statement (call_expression (member_expression (identifier) (property_identifier)) (arguments (parenthesized_expression (sequence_expression (identifier) (binary_expression (identifier) (array (identifier))))))))) (expression_statement (identifier)) (ERROR (call_expression (identifier) (arguments (identifier))) (identifier) (number) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))))) (binary_expression (identifier) (call_expression (identifier) (arguments (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))))) (binary_expression (identifier) (member_expression (identifier) (property_identifier))) (binary_expression (identifier) (member_expression (identifier) (property_identifier)))) (expression_statement (binary_expression (identifier) (ERROR (identifier)) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (identifier) (identifier)))))) (expression_statement (assignment_expression (identifier) (number))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (call_expression (identifier) (arguments (number) (call_expression (identifier) (arguments (identifier)))))) (augmented_assignment_expression (identifier) (subscript_expression (member_expression (identifier) (property_identifier)) (call_expression (identifier) (arguments (call_expression (identifier) (arguments (parenthesized_expression (sequence_expression (subscript_expression (identifier) (binary_expression (identifier) (number))) (subscript_expression (identifier) (identifier)))))))))))) (expression_statement (assignment_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (identifier))) (expression_statement (assignment_expression (subscript_expression (subscript_expression (identifier) (identifier)) (identifier)) (identifier))) (return_statement (call_expression (identifier) (arguments (identifier)))) (ERROR (ERROR (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (identifier) (number) (identifier) (number) (identifier) (identifier) (identifier)) (identifier)) (expression_statement (binary_expression (binary_expression (string) (call_expression (identifier) (arguments (member_expression (identifier) (property_identifier))))) (string))) (ERROR) (expression_statement (sequence_expression (identifier) (binary_expression (identifier) (ERROR (call_expression (member_expression (member_expression (identifier) (property_identifier)) (property_identifier)) (arguments))) (augmented_assignment_expression (identifier) (binary_expression (binary_expression (binary_expression (binary_expression (string) (call_expression (member_expression (identifier) (property_identifier)) (arguments))) (string)) (call_expression (identifier) (arguments (identifier)))) (string)))))) (return_statement (binary_expression (subscript_expression (identifier) (ERROR) (unary_expression (number))) (string))) (ERROR) (expression_statement (binary_expression (identifier) (ERROR (string)) (assignment_expression (identifier) (call_expression (member_expression (identifier) (property_identifier)) (arguments (string)))))) (expression_statement (call_expression (identifier) (arguments (call_expression (member_expression (identifier) (property_identifier)) (arguments))))))
